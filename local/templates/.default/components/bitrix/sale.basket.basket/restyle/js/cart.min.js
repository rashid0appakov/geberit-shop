"use strict";var SBB=SBB||{},_sbb_items_count=0,_sbb_start_load=0,_sbb_timer_load=0,_delay_load=_delay_load||0;SBB.Main={vars:{},setCartEvents:function(){if($(".cart .cart__counter-plus, .cart .cart__counter-minus").length){$(".cart .cart__counter-plus, .cart .cart__counter-minus").unbind("click").bind("click",function(a){a.preventDefault();_sbb_items_count=parseInt($(this).parent().find(".cart__counter-counter").text());if($(this).hasClass("cart__counter-minus")){if(_sbb_items_count>=1){_sbb_items_count-=1;if(_sbb_items_count==0){_sbb_items_count=1}else{$(this).parents("div.trCart").addClass("has-changed")}}else{_sbb_items_count=1}}else{_sbb_items_count+=1;$(this).parents("div.trCart").addClass("has-changed")}$(this).parent().find(".cart__counter-counter").text(_sbb_items_count);$(this).parent().find("input").val(_sbb_items_count);if(SC.getCurrentTime()-_sbb_start_load<=_delay_load){_sbb_timer_load=clearTimeout(_sbb_timer_load)}_sbb_timer_load=setTimeout("SBB.updateCartProducts();",_delay_load);_sbb_start_load=SC.getCurrentTime()})}if($(".enterCoupon label").length){$(".enterCoupon label").click(function(a){a.preventDefault();$(".enterCoupon label input").show("fast");$(".forCoupon").show();$(".enterCoupon label span").hide("fast");$(this).addClass("active")})}},updateCartProducts:function(){SC.delObject(_post);_post.method="cart-data";$('form.basket input[name^="BASKET"]').each(function(b,a){_post[$(this).attr("name")]=$(this).val()});SC.ajaxSendPost("/ajax/",_post,function(a){console.log(a);SC.vars.send=true;BX.closeWait("",SC.vars.wait);if(a.status=="success"){$.each(a.BASKET.ITEMS,function(c,b){if($("div.cart div.trCart[data-id="+b.ID+"]").length){if(b.DISCOUNT_INT!=0){$("#basket-item-price-old-text-"+b.ID).text(b.FULL_PRICE);$("#basket-item-price-"+b.ID).text(b.PRICE);$("#basket-item-sum-price-old-"+b.ID).text(b.FULL_PRICE_TOTAL);$("#basket-item-sum-price-difference-"+b.ID).html('<div class="basket-item-price-difference">Экономия '+b.DISCOUNT_TOTAL+"</div>")}else{$("#basket-item-price-old-text-"+b.ID).html("");$("#basket-item-price-"+b.ID).text(b.PRICE);$("#basket-item-sum-price-old-"+b.ID).html("");$("#basket-item-sum-price-difference-"+b.ID).html("")}$("div.cart div.trCart div.cart__counter-counter[data-id="+b.ID+"]").text(b.QUANTITY);$('div.cart div.trCart input[name="BASKET['+b.ID+']"]').val(b.QUANTITY);$("#basket-item-sum-price-"+b.ID).text(b.PRICE_TOTAL)}});$("#basket-full-total").text(a.BASKET.SUMM_FORMATED).attr("data-price",a.BASKET.SUMM_FORMATED);if(typeof SOA=="object"&&$("span.aside-price-full").length){$("span.aside-price-full").data("price",a.BASKET.SUMM);$("span.aside-price").text(a.BASKET.SUMM_FORMATED);$("span.aside-products-count i.value").text(a.BASKET.QUANTITY);SOA.getDeliveryServices()}}})},setLinksEvents:function(){$('.sendOrder a[href="#make-order"]').click(function(a){a.preventDefault();$("#tabHimself").click();$("html, body").animate({scrollTop:$($.attr(this,"href")).offset().top},800)});$("#basket-total-aside-block .buyOneClick").click(function(a){a.preventDefault();$("#tabExpress").click();$("html, body").animate({scrollTop:$($.attr(this,"href")).offset().top},800)})},selectDefaultGift:function(){$(".listPodarok").each(function(){if(!$(this).find(".choosePodarok:checked").length){if($(this).find(".choosePodarok").first().length){$(this).find(".choosePodarok").first().click()}}})},init:function(){var a=SBB.Main;$(function(){a.setCartEvents();a.setLinksEvents();a.selectDefaultGift()});return a}};SBB=SBB.Main.init();