$(document).ready(function(){$("#orderFullPrice").html($("#basket-full-total").html());$(".cart__counter-minus").on("click",function(c){c.preventDefault();var b=$(this).parents(".trCart").data("id");var d=parseInt($("#basket-item-"+b+" .cart__content-counter .cart__counter-counter").html())-1;window.BasketManager.ChangeQuantity({basketId:b,quantity:d,},$.proxy(function(e){window.location.reload();a(e)},this))});$(".cart__counter-plus").on("click",function(c){c.preventDefault();var b=$(this).parents(".trCart").data("id");var d=parseInt($("#basket-item-"+b+" .cart__content-counter .cart__counter-counter").html())+1;window.BasketManager.ChangeQuantity({basketId:b,quantity:d,},$.proxy(function(e){window.location.reload();a(e)},this))});$(".basket-item-action-remove").on("click",function(c){c.preventDefault();var b=$(this).parents(".trCart").data("id");SC.vars.wait=BX.showWait("");window.BasketManager.DeleteFromBasket({basketId:b},$.proxy(function(d){window.dataLayer=window.dataLayer||[];dataLayer.push({ecommerce:{currencyCode:"RUB",remove:{products:[{name:d.PRODUCT.NAME,id:d.PRODUCT.ID,price:d.PRODUCT.DISCOUNT_PRICE,quantity:1}]},},event:"pixel-mg-event","pixel-mg-event-category":"Enhanced Ecommerce","pixel-mg-event-action":"Removing a Product from a Shopping Cart","pixel-mg-event-non-interaction":"False"});if(!d.BASKET.PRODUCT_COUNT){window.location.reload()}if(d.BASKET_ID){$("#basket-item-"+d.BASKET_ID).slideUp("fast",function(){$(this).remove()})}a(d);BX.closeWait("",SC.vars.wait)},this))});var a=function(e){var i=e.BASKET.PRICE_FORMATTED;var g=e.BASKET.PRODUCT_COUNT;var b=e.BASKET_ID;var d=e.PRODUCT.ID;var f=e.PRODUCT.BASE_PRICE;var h=e.PRODUCT.DISCOUNT_PRICE;var c=e.QUANTITY;if(e.PRODUCT.FULL_PRICE==0){$("#basket-item-"+b).remove()}$("#basket-item-"+b+" .cart__content-counter .cart__counter-counter").html(c);$("#basket-full-total").html(i);$("#basket-item-sum-price-"+b).html(e.PRODUCT.FULL_PRICE_FORMATTED);$(".aside-price").html(i);$(".aside-price-full").html(i);$(".aside-products-count").html(g+" шт.")};$(document).on("basketitemquantitychange",function(c,b){window.location.reload();a(b)});$(".installation").on("click",function(d){var c=$(this).data("id");var b=0;if($(this).is(":checked")){b=1}t=$(this);$.ajax({type:"POST",url:"/local/templates/.default/ajax/basket/checkInstallation.php",data:{basketId:c,value:b,sessid:BX.bitrix_sessid(),},success:function(e){t.attr("checked",e.checked)}})});$("#applyCouponBtn").on("click",function(){var b=$("input.couponInput").val();$.ajax({type:"POST",url:"/local/templates/.default/ajax/basket/processCoupon.php",data:{apply:true,coupon:b,sessid:BX.bitrix_sessid(),},success:function(c){window.location.reload()}})});$(".empty-cart-btn").on("click",function(){$.ajax({type:"POST",url:"/local/templates/.default/ajax/basket/emptyBasket.php",data:{sessid:BX.bitrix_sessid(),},success:function(){window.location.reload()}})})});